!function(t){t.tour={},t.tour.options={steps:{},autoplay:!1,saveCookie:!1,current_step:0,showtime:4e3,mainTitle:"Take a Tour"},t.tour.start=function(t){try{return o.start(t||{})}catch(e){var s="Tour Error: "+e;"undefined"!=typeof console&&console.error?console.error(s,t):alert(s)}};var o={total_steps:0,step:0,start:function(e){t.extend(t.tour.options,e),o.total_steps=t.tour.options.steps.length,o.showControls()},begin:function(){t("#activatetour,#latertour").remove(),t("#endtour,#restarttour,.latertour").show(),!t.tour.options.autoplay&&o.total_steps>1&&t("#nextstep").show(),o.showOverlay(),o.next()},prev:function(){return t.tour.options.autoplay||(o.step>2?t("#prevstep").show():t("#prevstep").hide(),o.step==o.total_steps&&t("#nextstep").show()),o.step<=1?!1:(--o.step,void o.showTooltip())},next:function(){return t.tour.options.autoplay||(o.step>0?t("#prevstep").show():t("#prevstep").hide(),o.step==o.total_steps-1?t("#nextstep").hide():t("#nextstep").show()),o.step>=o.total_steps?(o.end(),!1):(++o.step,void o.showTooltip())},end:function(e){"undefined"==typeof e&&(e=!1),o.step=0,t.tour.options.autoplay&&clearTimeout(t.tour.options.showtime),o.hideTooltip(),o.hideControls(),o.hideOverlay(),1==t.tour.options.saveCookie&&0==e&&jQuery.Storage.set("tour","true")},restart:function(){o.step=0,t.tour.options.autoplay&&clearTimeout(t.tour.options.showtime),o.next()},cancel:function(t){o.end(t)},hideOverlay:function(){t("#tour_overlay").remove()},showOverlay:function(){t("body").prepend('<div id="tour_overlay" class="overlay"></div>')},hideControls:function(){t("#tourcontrols").remove()},showControls:function(){var e='<div id="tourcontrols" class="tourcontrols">';e+="<p>"+t.tour.options.mainTitle+"</p>",e+='<span class="tour-button" id="activatetour">Start the Tour</span>',e+='<span id="latertour" class="tour-button latertour">Remind me Later</span>',t.tour.options.autoplay||(e+='<div class="nav"><span class="tour-button" id="prevstep" style="display:none;">< Previous</span>',e+='<span class="tour-button" id="nextstep" style="display:none;">Next ></span></div>'),e+='<a id="restarttour" style="display:none;">Restart the Tour</span>',e+='<a id="endtour" style="display:none;">End the Tour</a>',e+='<a class="latertour" style="display:none;">Remind me Later</a>',e+='<span class="close" id="canceltour"></span>',e+="</div>",t("body").prepend(e),t("#tourcontrols").animate({right:"30px"},500);var s=t("body").find("#tourcontrols");s.find("#activatetour").on("click",function(){o.begin()}),s.find(".latertour").on("click",function(){o.cancel(!0)}),s.find("#canceltour").on("click",function(){o.cancel(!1)}),s.find("#endtour").on("click",function(){o.cancel(!1)}),s.find("#restarttour").on("click",function(){o.restart()}),s.find("#nextstep").on("click",function(){o.next()}),s.find("#prevstep").on("click",function(){o.prev()})},hideTooltip:function(){t("#tour_tooltip").remove()},showTooltip:function(){o.hideTooltip();var e=t.tour.options.steps[o.step-1],s=t("."+e.name);t.tour.options.autoplay&&(t.tour.options.showtime=setTimeout(o.next(),e.time));var r=e.bgcolor,a=e.color,n=t("<div>",{id:"tour_tooltip","class":"tooltip",html:"<p>"+e.text+'</p><span class="tooltip_arrow"></span>'}).css({display:"none","background-color":r,color:a}),i={},p=e.position;t("body").prepend(n);var l=s.outerWidth(),d=s.outerHeight(),u=s.offset().left,c=s.offset().top;switch(p){case"TL":i={left:u,top:c+d+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_TL");break;case"TR":i={left:u+l-n.width()+"px",top:c+d+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_TR");break;case"BL":i={left:u+"px",top:c-n.height()+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_BL");break;case"BR":i={left:u+l-n.width()+"px",top:c-n.height()+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_BR");break;case"LT":i={left:u+l+"px",top:c+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_LT");break;case"LB":i={left:u+l+"px",top:c+d-n.height()+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_LB");break;case"RT":i={left:u-n.width()+"px",top:c+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_RT");break;case"RB":i={left:u-n.width()+"px",top:c+d-n.height()+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_RB");break;case"T":i={left:u+l/2-n.width()/2+"px",top:c+d+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_T");break;case"R":i={left:u-n.width()+"px",top:c+d/2-n.height()/2+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_R");break;case"B":i={left:u+l/2-n.width()/2+"px",top:c-n.height()+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_B");break;case"L":i={left:u+l+"px",top:c+d/2-n.height()/2+"px"},n.find("span.tooltip_arrow").addClass("tooltip_arrow_L")}var h=t(window).scrollTop(),f=t(window).scrollTop()+t(window).height(),w=parseFloat(i.top,10);w>c&&(w=c);var _=parseFloat(i.top,10)+n.height();c+d>_&&(_=c+d),h>w||w>f||h>_||_>f?t("html, body").stop().animate({scrollTop:w},500,"easeInOutExpo",function(){t.tour.options.autoplay&&(clearTimeout(t.tour.options.showtime),t.tour.options.showtime=setTimeout(o.next(),e.time)),n.css(i).show()}):n.css(i).show()}}}(jQuery);
